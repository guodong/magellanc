struct Packet {
  ip_t src_ip
  ip_t dst_ip
  port_t src_port
  port_t dst_port
  int8_t protocol
}

# check whether port open
bool isOpen(port_t port) {
  port_t[2] openPorts = [8080, 8081]
  bool open = 0
  int i = 0
  for (i; i < 2; i = i + 1) {
    if (port == openPorts[i]) {
      open = 1
    }
  }
  return open
}

int onPacket(struct Packet p) {

  int egress = 0

  if (p.src_ip == 167772161) {
     if (p.dst_ip == 167772162) {
       if (p.dst_port < 1025) {
         egress = 1
        } else {
          if (isOpen(p.dst_port)) {
	    egress = 2
	  }
	    
        }
     }
  }
  return egress
}

